<div class="container">
    <div class="admin-section">
        <h3>Pending Registrations</h3>
        <table>
            <thead>
                <tr><th>Name</th><th>Position</th><th>Team</th><th>Action</th></tr>
            </thead>
            <tbody id="pending-list"></tbody>
        </table>
    </div>

    <div class="admin-section">
        <h3>Edit Standings (JSON format)</h3>
        <textarea id="standingsJSON" style="width:100%; height:150px; background:#222; color:var(--pl-neon)"></textarea>
        <button onclick="updateStandings()">Save Standings</button>
    </div>
</div>

<script>
    const API = 'http://localhost:3000/api';

    async function loadAdmin() {
        const res = await fetch(`${API}/data`);
        const data = await res.json();
        
        // Load Pending
        const list = document.getElementById('pending-list');
        list.innerHTML = data.pendingPlayers.map(p => `
            <tr>
                <td>${p.name}</td>
                <td>${p.pos}</td>
                <td>${p.team}</td>
                <td>
                    <button class="approve" onclick="handlePlayer(${p.id}, 'approve')">Approve</button>
                    <button class="reject" onclick="handlePlayer(${p.id}, 'reject')">Reject</button>
                </td>
            </tr>
        `).join('');

        // Load Standings into Editor
        document.getElementById('standingsJSON').value = JSON.stringify(data.standings, null, 2);
    }

    async function handlePlayer(id, action) {
        await fetch(`${API}/admin/approve`, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ id, action })
        });
        loadAdmin();
    }

    async function updateStandings() {
        const newData = JSON.parse(document.getElementById('standingsJSON').value);
        await fetch(`${API}/admin/update-standings`, {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(newData)
        });
        alert("Standings Updated!");
    }

    loadAdmin();
</script>